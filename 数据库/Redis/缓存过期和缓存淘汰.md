# 缓存过期和缓存淘汰

redis的数据都保存在内存中，不能无节制的存下去，一般会设置一个过期时间，当缓存过期时，redis有两种删除策略：

1. 定期删除：redis会周期性的检查key，如果过期则清理删除，但由于检查所有key消耗太大，redis周期性检查只会检查一部分。
2. 惰性删除：对于每次都逃过定期检查的key，当客户端再次请求时，则删除

这两种方案有一个问题，当存在大量的过期的key每次都逃过定期删除，客户端又不去请求时，这些数据会一直存在内存中，导致内存占满，对于这种情况，redis有一个内存淘汰策略，当内存达到设置的最大值时进行处理：

1. noeviction：返回错误，不会删除任何键值
2. allkeys-lru：使用LRU算法删除最近最少使用的key
3. allkeys-rendom：从所有key随机删除
4. allkeys-lfu：从所有键中删除使用频率最少的键
5. volatile-lru：使用LRU算法从设置了过期时间的键的集合中删除最近最少使用的key
6. volatile-rendom：从设置了过期时间的键的集合中随机删除
7. volatile-lfu：从设置了过期时间的键的集合中删除使用频率最少的键
8. volatile-ttl：从设置了过期时间的键中删除剩余时间最短的键
